import{_ as A,m as M,p as b,q as c,t as d,x as u,I as N,R as x,G as v,H as t,F as h,C as l,S as F,T as I,B as Q,U as T,V as k,W as L,D as U,d as m,r as Y,w as z,X as E,Y as q,Z as G,$ as O}from"./index-Co29iDXF.js";const W=M({name:"ReceiptView",props:{model:{type:Object,default:()=>{}},show:{type:Boolean}},emits:["update:onCancel"],setup(a,{emit:e}){const g=E.description,{$q:w,$date:p}=U(),i=m(()=>a.model),n=Y(!1),V=m(()=>!i.value||!Array.isArray(i.value.items)?0:i.value.items.reduce((s,o)=>s+o.sub_total,0)),$=m(()=>p.formatDate(Date.now(),"DD/MM/YYYY HH:mm")),R=s=>s?p.formatDate(s,"DD/MM/YYYY"):"-",B=s=>s?.toLocaleString(),H=m(()=>i.value?.code??i.value?.name??i.value?.id),y=Y(null),P=async s=>{const o=s.cloneNode(!0);o.style.maxHeight="none",o.style.overflow="visible",o.style.position="fixed",o.style.top="-9999px",o.style.left="0",o.style.zIndex="-1",o.style.width=s.offsetWidth+"px",document.body.appendChild(o),await new Promise(r=>requestAnimationFrame(r)),await new Promise(r=>requestAnimationFrame(r));const f=await O(o,{useCORS:!0,scale:2,backgroundColor:"#ffffff"});return document.body.removeChild(o),f},S=async()=>{q.show({group:"receipt",message:"Download PDF",spinnerSize:"4em",backgroundColor:"rgba(0,0,0,0.4)"});try{const s=y.value;if(!s)return;const o=await P(s),f=o.toDataURL("image/png"),r=58,C=o.height*r/o.width,D=new G({unit:"mm",format:[r,C]});D.addImage(f,"PNG",0,0,r,C),D.save(`${p.formatDate(Date.now(),"DD/MM/YYYY HH:mm:ss")}.pdf`)}catch(s){return w.notify({type:"info",color:"negative",message:s.message||s,progress:!0,timeout:3e3})}finally{e("update:onCancel",!1),q.hide("receipt")}};return z(()=>a.show,s=>n.value=s),{product:g,data:i,dialog:n,total:V,now:$,formatDate:R,n:B,caption:H,view:y,makePdf:S}}}),j={ref:"view",class:"receipt-container"},J={class:"text-center q-mb-md"},X={class:"receipt-title"},Z={class:"receipt-row"},K={class:"receipt-row"},_={class:"receipt-sub-row"},ee={class:"receipt-row total"},te={class:"q-mt-xs text-center text-caption"};function ae(a,e,g,w,p,i){return c(),b(L,{modelValue:a.dialog,"onUpdate:modelValue":e[1]||(e[1]=n=>a.dialog=n),persistent:""},{default:d(()=>[u(N,{dark:""},{default:d(()=>[u(v,null,{default:d(()=>[...e[2]||(e[2]=[t("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),a.data.id?(c(),b(v,{key:0,style:{"max-height":"50vh"},class:"scroll"},{default:d(()=>[t("div",j,[t("div",J,[t("div",X,l(a.product),1),e[3]||(e[3]=t("div",{class:"receipt-sub"},"Jakarta, Indonesia",-1)),e[4]||(e[4]=t("div",{class:"receipt-sub"},"Telp: 0812-1234-5678",-1))]),t("div",Z,[e[5]||(e[5]=t("span",null,"Date",-1)),t("span",null,l(a.formatDate(a.data?.updated_at)??"-"),1)]),t("div",K,[e[6]||(e[6]=t("span",null,"Cashier",-1)),t("span",null,l(a.data.created_by?.name??"-"),1)]),e[8]||(e[8]=t("hr",null,null,-1)),(c(!0),h(F,null,I(a.data?.items,n=>(c(),h("section",{if:"",key:n.id,class:"receipt-item"},[t("div",null,l(n.product?.name),1),t("div",_,[t("span",null,l(n.quantity)+" x Rp "+l(a.n(n.price)),1),t("span",null,"Rp "+l(a.n(n.quantity*n.price)),1)])]))),128)),e[9]||(e[9]=t("hr",null,null,-1)),t("div",ee,[e[7]||(e[7]=t("b",null,"Total",-1)),t("b",null,"Rp "+l(a.n(a.total)),1)]),e[10]||(e[10]=t("div",{class:"q-mt-lg text-center text-caption"},"Thank you for shopping!",-1)),t("div",te,l(a.now),1)],512)]),_:1})):x("",!0),u(v,{class:"q-pt-xs"},{default:d(()=>[Q(" Are your print "+l(a.caption)+"? ",1)]),_:1}),u(T,{align:"right"},{default:d(()=>[u(k,{label:"cancel",color:"negative",onClick:e[0]||(e[0]=n=>a.$emit("update:onCancel",!1))}),u(k,{label:"sure",color:"primary",onClick:a.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const oe=A(W,[["render",ae],["__scopeId","data-v-dc95fc34"]]);export{oe as default};
