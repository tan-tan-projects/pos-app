import{_ as g,m as w,R as C,p as y,q as v,t as n,x as o,I as V,G as c,H as k,B as $,C as h,S as _,T as p,U as B,V as P,D as Q,r as u,d as S,w as b}from"./index-DsK_gbIG.js";const q=w({name:"CanvasView",components:{ViewPage:P},props:{model:{type:Object,default:()=>{}},storename:{type:String},show:{type:Boolean}},emits:["update:onCancel"],setup(e,{emit:a}){const{$q:s,$router:m}=Q(),r=u(!1),i=u(null),d=async()=>{try{const t=i.value;if(!t)throw new Error("Failed to process pdf");if(s.platform.is.ios||s.platform.is.safari){const f=m.resolve({path:`/download/receipt/${e.storename}`,query:{data:encodeURIComponent(JSON.stringify(e.model))}});window.open(f.href,"_blank")}else return t.print()}catch(t){return s.notify({type:"info",color:"negative",message:t.message||t,progress:!0,timeout:3e3})}finally{a("update:onCancel",!1)}},l=S(()=>e.model?.code??e.model?.name??e.model?.id);return b(()=>e.show,t=>r.value=t),{dialog:r,view:i,makePdf:d,caption:l}}});function A(e,a,s,m,r,i){const d=C("ViewPage");return v(),y(B,{modelValue:e.dialog,"onUpdate:modelValue":a[1]||(a[1]=l=>e.dialog=l),persistent:""},{default:n(()=>[o(V,{dark:""},{default:n(()=>[o(c,null,{default:n(()=>[...a[2]||(a[2]=[k("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),o(c,{style:{"max-height":"50vh"},class:"scroll"},{default:n(()=>[o(d,{ref:"view",model:e.model},null,8,["model"])]),_:1}),o(c,{class:"q-pt-none"},{default:n(()=>[$(" Are your print "+h(e.caption)+"? ",1)]),_:1}),o(_,{align:"right"},{default:n(()=>[o(p,{label:"cancel",color:"negative",onClick:a[0]||(a[0]=l=>e.$emit("update:onCancel",!1))}),o(p,{label:"sure",color:"primary",onClick:e.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const U=g(q,[["render",A]]);export{U as default};
