import{_ as S,m as U,p as D,q as p,t as i,x as d,I as H,R as I,G as w,H as t,F as R,S as M,C as n,T as O,U as F,B as j,V as E,W as V,X as G,D as x,d as c,r as h,w as J,Y as W,Z as X,$ as Z}from"./index-DU7IF39Q.js";const z=U({name:"ReceiptView",props:{model:{type:Object,default:()=>{}},show:{type:Boolean}},emits:["update:onCancel"],setup(a,{emit:e}){const g=W.description,{$q:m,$date:f}=x(),l=c(()=>a.model),o=h(!1),Y=c(()=>!l.value||!Array.isArray(l.value.items)?0:l.value.items.reduce((s,u)=>s+u.sub_total,0)),$=c(()=>f.formatDate(Date.now(),"DD/MM/YYYY HH:mm")),q=s=>s?f.formatDate(s,"DD/MM/YYYY"):"-",B=s=>s?.toLocaleString(),P=c(()=>l.value?.code??l.value?.name??l.value?.id),y=h(null);let r=null;const T=async()=>{try{const s=y.value;if(!s)return;const u=await X(s,{useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff",scale:window.devicePixelRatio>1?2:1}),A=u.toDataURL("image/png"),v=58,b=u.height*v/u.width,C=new Z({unit:"mm",format:[v,b]});C.addImage(A,"PNG",0,0,v,b),r=C;const k=m.dialog({dark:!0,title:"PDF Ready",message:"Choose action",options:{type:"radio",model:"preview",items:[{label:"Preview",value:"preview"},{label:"Download",value:"download"}]},ok:{label:"Apply",color:"primary"},cancel:{label:"Close",color:"negative"},persistent:!0});k.onOk(L=>{if(r){if(L==="preview"){const N=r.output("blob"),Q=URL.createObjectURL(N);window.open(Q,"_blank")}else r.save("vue-test.pdf");e("update:onCancel",!1)}}),k.onCancel(()=>{r=null,e("update:onCancel",!1)})}catch(s){return m.notify({type:"info",color:"negative",message:s.message||s,progress:!0,timeout:3e3})}};return J(()=>a.show,s=>o.value=s),{product:g,data:l,dialog:o,total:Y,now:$,formatDate:q,n:B,caption:P,view:y,instance:r,makePdf:T}}}),K={ref:"view",class:"receipt-container"},_={class:"text-center q-mb-md"},ee={class:"receipt-title"},te={class:"receipt-row"},ae={class:"receipt-row"},se={class:"receipt-sub-row"},oe={class:"receipt-row total"},ne={class:"q-mt-xs text-center text-caption"};function le(a,e,g,m,f,l){return p(),D(G,{modelValue:a.dialog,"onUpdate:modelValue":e[1]||(e[1]=o=>a.dialog=o),persistent:""},{default:i(()=>[d(H,{dark:""},{default:i(()=>[d(w,null,{default:i(()=>[...e[2]||(e[2]=[t("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),a.data.id?(p(),D(w,{key:0,style:{"max-height":"50vh"},class:"scroll"},{default:i(()=>[t("div",K,[t("div",_,[e[3]||(e[3]=t("img",{src:M,width:"50"},null,-1)),t("div",ee,n(a.product),1),e[4]||(e[4]=t("div",{class:"receipt-sub"},"Jakarta, Indonesia",-1)),e[5]||(e[5]=t("div",{class:"receipt-sub"},"Telp: 0812-1234-5678",-1))]),t("div",te,[e[6]||(e[6]=t("span",null,"Date",-1)),t("span",null,n(a.formatDate(a.data?.updated_at)??"-"),1)]),t("div",ae,[e[7]||(e[7]=t("span",null,"Cashier",-1)),t("span",null,n(a.data.created_by?.name??"-"),1)]),e[9]||(e[9]=t("hr",null,null,-1)),(p(!0),R(O,null,F(a.data?.items,o=>(p(),R("section",{if:"",key:o.id,class:"receipt-item"},[t("div",null,n(o.product?.name),1),t("div",se,[t("span",null,n(o.quantity)+" x Rp "+n(a.n(o.price)),1),t("span",null,"Rp "+n(a.n(o.quantity*o.price)),1)])]))),128)),e[10]||(e[10]=t("hr",null,null,-1)),t("div",oe,[e[8]||(e[8]=t("b",null,"Total",-1)),t("b",null,"Rp "+n(a.n(a.total)),1)]),e[11]||(e[11]=t("div",{class:"q-mt-lg text-center text-caption"},"Thank you for shopping!",-1)),t("div",ne,n(a.now),1)],512)]),_:1})):I("",!0),d(w,{class:"q-pt-xs"},{default:i(()=>[j(" Are your print "+n(a.caption)+"? ",1)]),_:1}),d(E,{align:"right"},{default:i(()=>[d(V,{label:"cancel",color:"negative",onClick:e[0]||(e[0]=o=>a.$emit("update:onCancel",!1))}),d(V,{label:"sure",color:"primary",onClick:a.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ie=S(z,[["render",le],["__scopeId","data-v-59152f7e"]]);export{ie as default};
