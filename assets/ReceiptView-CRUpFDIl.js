import{_ as P,m as S,p as T,q as f,t as i,x as r,I as O,G as v,H as t,F as k,R as Q,C as n,S as A,T as E,B as I,U as N,V as C,W as j,D as F,d as c,r as R,w as G,X as x,Y,Z as z,$ as J}from"./index-CEC7Zlic.js";const W=S({name:"ReceiptView",props:{model:{type:Object,default:()=>{}},show:{type:Boolean}},emits:["update:onCancel"],setup(a,{emit:e}){const g=x.description,{$q:w,$date:u}=F(),l=c(()=>a.model),o=R(!1),h=c(()=>!l.value||!Array.isArray(l.value.items)?0:l.value.items.reduce((s,d)=>s+d.sub_total,0)),$=c(()=>u.formatDate(Date.now(),"DD/MM/YYYY HH:mm")),V=s=>s?u.formatDate(s,"DD/MM/YYYY"):"-",q=s=>s?.toLocaleString(),B=c(()=>l.value?.code??l.value?.name??l.value?.id),b=R(null),L=async()=>{Y.show({group:"receipt",message:"Download PDF",spinnerSize:"4em",backgroundColor:"rgba(0,0,0,0.4)"});try{const s=b.value;if(!s)return;const d=await z(s,{useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff",scale:window.devicePixelRatio>1?2:1}),M=d.toDataURL("image/png"),m=58,D=d.height*m/d.width,y=new J({unit:"mm",format:[m,D]});y.addImage(M,"PNG",0,0,m,D);const U=y.output("arraybuffer"),H=new Blob([U],{type:"application/pdf"}),p=document.createElement("a");p.href=URL.createObjectURL(H),p.download=`${u.formatDate(Date.now(),"DD/MM/YYYY HH:mm:ss")}.pdf`,p.click(),URL.revokeObjectURL(p.href)}catch(s){return w.notify({type:"info",color:"negative",message:s.message||s,progress:!0,timeout:3e3})}finally{e("update:onCancel",!1),Y.hide("receipt")}};return G(()=>a.show,s=>o.value=s),{product:g,data:l,dialog:o,total:h,now:$,formatDate:V,n:q,caption:B,view:b,makePdf:L}}}),X={ref:"view",class:"receipt-container"},Z={class:"text-center q-mb-md"},K={class:"receipt-title"},_={class:"receipt-row"},ee={class:"receipt-row"},te={class:"receipt-sub-row"},ae={class:"receipt-row total"},se={class:"q-mt-xs text-center text-caption"};function oe(a,e,g,w,u,l){return f(),T(j,{modelValue:a.dialog,"onUpdate:modelValue":e[1]||(e[1]=o=>a.dialog=o),persistent:""},{default:i(()=>[r(O,{dark:""},{default:i(()=>[r(v,null,{default:i(()=>[...e[2]||(e[2]=[t("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),r(v,{style:{"max-height":"50vh"},class:"scroll"},{default:i(()=>[t("div",X,[e[9]||(e[9]=t("div",{class:"pdf-watermark"},"DEMO",-1)),t("div",Z,[e[3]||(e[3]=t("img",{src:Q,width:"40"},null,-1)),t("div",K,n(a.product),1),e[4]||(e[4]=t("div",{class:"receipt-sub"},"Jakarta, Indonesia",-1)),e[5]||(e[5]=t("div",{class:"receipt-sub"},"Telp: 0812-1234-5678",-1))]),t("div",_,[e[6]||(e[6]=t("span",null,"Date",-1)),t("span",null,n(a.formatDate(a.data?.updated_at)??"-"),1)]),t("div",ee,[e[7]||(e[7]=t("span",null,"Cashier",-1)),t("span",null,n(a.data.created_by?.name??"-"),1)]),e[10]||(e[10]=t("hr",null,null,-1)),(f(!0),k(A,null,E(a.data?.items,o=>(f(),k("section",{if:"",key:o.id,class:"receipt-item"},[t("div",null,n(o.product?.name),1),t("div",te,[t("span",null,n(o.quantity)+" x Rp "+n(a.n(o.price)),1),t("span",null,"Rp "+n(a.n(o.quantity*o.price)),1)])]))),128)),e[11]||(e[11]=t("hr",null,null,-1)),t("div",ae,[e[8]||(e[8]=t("b",null,"Total",-1)),t("b",null,"Rp "+n(a.n(a.total)),1)]),e[12]||(e[12]=t("div",{class:"q-mt-lg text-center text-caption"},"Thank you for shopping!",-1)),t("div",se,n(a.now),1)],512)]),_:1}),r(v,{class:"q-pt-none"},{default:i(()=>[I(" Are your print "+n(a.caption)+"? ",1)]),_:1}),r(N,{align:"right"},{default:i(()=>[r(C,{label:"cancel",color:"negative",onClick:e[0]||(e[0]=o=>a.$emit("update:onCancel",!1))}),r(C,{label:"sure",color:"primary",onClick:a.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const le=P(W,[["render",oe],["__scopeId","data-v-3373178b"]]);export{le as default};
