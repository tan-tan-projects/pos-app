import{_ as P,m as S,F as p,q as c,x as i,R as T,t as d,I as N,G as C,H as t,B as Q,C as o,S as A,T as b,U as I,V as F,W as k,X as L,D as U,d as m,r as Y,w as E,Y as G,Z as V,$ as O,a0 as j}from"./index-fnm8zYBb.js";const z=S({name:"ReceiptView",props:{model:{type:Object,default:()=>{}},show:{type:Boolean}},emits:["update:onCancel"],setup(a,{emit:e}){const g=G.description,{$q:v,$date:u}=U(),l=m(()=>a.model),n=Y(!1),$=m(()=>!l.value||!Array.isArray(l.value.items)?0:l.value.items.reduce((s,r)=>s+r.sub_total,0)),R=m(()=>u.formatDate(Date.now(),"DD/MM/YYYY HH:mm")),q=s=>s?u.formatDate(s,"DD/MM/YYYY"):"-",h=s=>s?.toLocaleString(),B=m(()=>l.value?.code??l.value?.name??l.value?.id),w=Y(null),H=async()=>{V.show({group:"receipt",message:"Download PDF",spinnerSize:"4em",backgroundColor:"rgba(0,0,0,0.4)"});try{const s=w.value;if(!s)return;const r=await O(s,{useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff",scale:window.devicePixelRatio>1?2:1}),M=r.toDataURL("image/png"),f=58,D=r.height*f/r.width,y=new j({unit:"mm",format:[f,D]});y.addImage(M,"PNG",0,0,f,D),y.save(`${u.formatDate(Date.now(),"DD/MM/YYYY HH:mm:ss")}.pdf`)}catch(s){return v.notify({type:"info",color:"negative",message:s.message||s,progress:!0,timeout:3e3})}finally{e("update:onCancel",!1),V.hide("receipt")}};return E(()=>a.show,s=>n.value=s),{product:g,data:l,dialog:n,total:$,now:R,formatDate:q,n:h,caption:B,view:w,makePdf:H}}}),J={key:0,ref:"view",class:"receipt-container"},W={class:"text-center q-mb-md"},X={class:"receipt-title"},Z={class:"receipt-row"},K={class:"receipt-row"},x={class:"receipt-sub-row"},_={class:"receipt-row total"},ee={class:"q-mt-xs text-center text-caption"};function te(a,e,g,v,u,l){return c(),p(k,null,[i(I,{modelValue:a.dialog,"onUpdate:modelValue":e[1]||(e[1]=n=>a.dialog=n),persistent:""},{default:d(()=>[i(N,{dark:""},{default:d(()=>[i(C,null,{default:d(()=>[...e[2]||(e[2]=[t("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),i(C,{class:"q-pt-none"},{default:d(()=>[Q(" Are your print "+o(a.caption)+"? ",1)]),_:1}),i(A,{align:"right"},{default:d(()=>[i(b,{label:"cancel",color:"negative",onClick:e[0]||(e[0]=n=>a.$emit("update:onCancel",!1))}),i(b,{label:"sure",color:"primary",onClick:a.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a.data?.id?(c(),p("div",J,[t("div",W,[e[3]||(e[3]=t("img",{src:F,width:"40"},null,-1)),t("div",X,o(a.product),1),e[4]||(e[4]=t("div",{class:"receipt-sub"},"Jakarta, Indonesia",-1)),e[5]||(e[5]=t("div",{class:"receipt-sub"},"Telp: 0812-1234-5678",-1))]),t("div",Z,[e[6]||(e[6]=t("span",null,"Date",-1)),t("span",null,o(a.formatDate(a.data?.updated_at)??"-"),1)]),t("div",K,[e[7]||(e[7]=t("span",null,"Cashier",-1)),t("span",null,o(a.data.created_by?.name??"-"),1)]),e[9]||(e[9]=t("hr",null,null,-1)),(c(!0),p(k,null,L(a.data?.items,n=>(c(),p("section",{if:"",key:n.id,class:"receipt-item"},[t("div",null,o(n.product?.name),1),t("div",x,[t("span",null,o(n.quantity)+" x Rp "+o(a.n(n.price)),1),t("span",null,"Rp "+o(a.n(n.quantity*n.price)),1)])]))),128)),e[10]||(e[10]=t("hr",null,null,-1)),t("div",_,[e[8]||(e[8]=t("b",null,"Total",-1)),t("b",null,"Rp "+o(a.n(a.total)),1)]),e[11]||(e[11]=t("div",{class:"q-mt-lg text-center text-caption"},"Thank you for shopping!",-1)),t("div",ee,o(a.now),1)],512)):T("",!0)],64)}const se=P(z,[["render",te],["__scopeId","data-v-66caaebf"]]);export{se as default};
