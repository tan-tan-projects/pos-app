import{_ as U,m as F,p as D,q as p,t as r,x as d,I as H,R as I,G as g,H as t,F as R,S as M,C as n,T as O,U as G,B as j,V as x,W as h,X as E,D as z,d as c,r as V,w as J,Y as W,Z as Y,n as X,$ as Z,a0 as K}from"./index-CbMuUJfe.js";const _=F({name:"ReceiptView",props:{model:{type:Object,default:()=>{}},show:{type:Boolean}},emits:["update:onCancel"],setup(a,{emit:e}){const w=W.description,{$q:m,$date:f}=z(),l=c(()=>a.model),o=V(!1),$=c(()=>!l.value||!Array.isArray(l.value.items)?0:l.value.items.reduce((s,u)=>s+u.sub_total,0)),q=c(()=>f.formatDate(Date.now(),"DD/MM/YYYY HH:mm")),P=s=>s?f.formatDate(s,"DD/MM/YYYY"):"-",B=s=>s?.toLocaleString(),T=c(()=>l.value?.code??l.value?.name??l.value?.id),b=V(null);let i=null;const S=async()=>{Y.show({group:"receipt",message:"Generating PDF...",spinnerSize:"4em",backgroundColor:"rgba(0,0,0,0.4)"});try{await X();const s=b.value;if(!s)return;const u=await Z(s,{useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff",scale:window.devicePixelRatio>1?2:1}),A=u.toDataURL("image/png"),v=58,y=u.height*v/u.width,C=new K({unit:"mm",format:[v,y]});C.addImage(A,"PNG",0,0,v,y),i=C;const k=m.dialog({dark:!0,title:"PDF Ready",message:"Choose action",options:{type:"radio",model:"preview",items:[{label:"Preview",value:"preview"},{label:"Download",value:"download"}]},ok:{label:"Apply",color:"primary"},cancel:{label:"Close",color:"negative"},persistent:!0});k.onOk(L=>{if(i){if(L==="preview"){const N=i.output("blob"),Q=URL.createObjectURL(N);window.open(Q,"_blank")}else i.save("vue-test.pdf");e("update:onCancel",!1)}}),k.onCancel(()=>{i=null,e("update:onCancel",!1)})}catch(s){return m.notify({type:"info",color:"negative",message:s.message||s,progress:!0,timeout:3e3})}finally{Y.hide("receipt")}};return J(()=>a.show,s=>o.value=s),{product:w,data:l,dialog:o,total:$,now:q,formatDate:P,n:B,caption:T,view:b,instance:i,makePdf:S}}}),ee={ref:"view",class:"receipt-container"},te={class:"text-center q-mb-md"},ae={class:"receipt-title"},se={class:"receipt-row"},oe={class:"receipt-row"},ne={class:"receipt-sub-row"},le={class:"receipt-row total"},ie={class:"q-mt-xs text-center text-caption"};function re(a,e,w,m,f,l){return p(),D(E,{modelValue:a.dialog,"onUpdate:modelValue":e[1]||(e[1]=o=>a.dialog=o),persistent:""},{default:r(()=>[d(H,{dark:""},{default:r(()=>[d(g,null,{default:r(()=>[...e[2]||(e[2]=[t("div",{class:"text-h6"},"Confirmation",-1)])]),_:1}),a.data.id?(p(),D(g,{key:0,style:{"max-height":"50vh"},class:"scroll"},{default:r(()=>[t("div",ee,[t("div",te,[e[3]||(e[3]=t("img",{src:M,width:"50"},null,-1)),t("div",ae,n(a.product),1),e[4]||(e[4]=t("div",{class:"receipt-sub"},"Jakarta, Indonesia",-1)),e[5]||(e[5]=t("div",{class:"receipt-sub"},"Telp: 0812-1234-5678",-1))]),t("div",se,[e[6]||(e[6]=t("span",null,"Date",-1)),t("span",null,n(a.formatDate(a.data?.updated_at)??"-"),1)]),t("div",oe,[e[7]||(e[7]=t("span",null,"Cashier",-1)),t("span",null,n(a.data.created_by?.name??"-"),1)]),e[9]||(e[9]=t("hr",null,null,-1)),(p(!0),R(O,null,G(a.data?.items,o=>(p(),R("section",{if:"",key:o.id,class:"receipt-item"},[t("div",null,n(o.product?.name),1),t("div",ne,[t("span",null,n(o.quantity)+" x Rp "+n(a.n(o.price)),1),t("span",null,"Rp "+n(a.n(o.quantity*o.price)),1)])]))),128)),e[10]||(e[10]=t("hr",null,null,-1)),t("div",le,[e[8]||(e[8]=t("b",null,"Total",-1)),t("b",null,"Rp "+n(a.n(a.total)),1)]),e[11]||(e[11]=t("div",{class:"q-mt-lg text-center text-caption"},"Thank you for shopping!",-1)),t("div",ie,n(a.now),1)],512)]),_:1})):I("",!0),d(g,{class:"q-pt-xs"},{default:r(()=>[j(" Are your print "+n(a.caption)+"? ",1)]),_:1}),d(x,{align:"right"},{default:r(()=>[d(h,{label:"cancel",color:"negative",onClick:e[0]||(e[0]=o=>a.$emit("update:onCancel",!1))}),d(h,{label:"sure",color:"primary",onClick:a.makePdf},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ue=U(_,[["render",re],["__scopeId","data-v-9e9b489e"]]);export{ue as default};
